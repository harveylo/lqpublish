- [参见](https://www.jianshu.com/p/1782e14a0766)
- 相当于使用汇编语言写内联函数
- 使用**asm**关键字标识内联函数的声明
- 能够操作c语言的变量
- # 汇编格式
	- GCC使用AT&T汇编语法
		- ``Op-dode src dst``
		- 使用寄存器要加%
		- 立即数必须有有\$前缀，引用C语言静态变量也必须要放上$前缀
			- 用0x标识16进制数
		- 操作符的最后一个字符决定操作数访问内存的长度
			- b：字节
			- w：字(16字节)
			- l：32字节
		- 内存操作数：
			- section: disp(base, index, scale)
			- 常数用作disp或scale时，不加前缀$
- # 基本内联汇编
	- 格式：``asm("assembly code")``
	- 当asm和程序中其他变量有冲突时，可以改用``__asm__``
	- 如果内联汇编有多条指令，每行要加上双引号，且改行以``\n\t``结尾
	- 例子：
		- ```
		  __asm__ ( "movl %eax, %ebx\n\t"
		                   "movl $56, %esi\n\t"
		                   "movl %ecx, $label(%edx,%ebx,$4)\n\t"
		                   "movb %ah, (%ebx)");
		  ```
	- 在内联代码中操作一些寄存器很有可能会产生一些难以预料的情况
		- 要避免可以在退出时做一些还原操作
- # 扩展内联汇编
	- 基本内联汇编只涉及到嵌入汇编指令
	- 扩展形式中，还可以指定操作数，选择输入输出寄存器，指明要修改的寄存器列表
		- 并不一定显式指明要访问的寄存器，可以留给gcc自己去选择
	- 格式：
		- ```
		  asm ( assembler template
		          : output operands                /* optional */
		          : input operands                   /* optional */
		          : list of clobbered registers   /* optional */
		  );
		  ```
	- ## 汇编模板
		- 就是嵌入在C程序中的汇编指令
		- 每条指令放在一个双引号内，或者将所有的指令都放着一个双引号内，然后使用``;``分割。
		- 每条指令都要包含一个分隔符。合法的分隔符是换行符(``\n``)或者分号。用换行符的时候通常后面放一个制表符``\t``。对此前文已经有所说明。
		- 访问C语言变量用%0,%1…等等。
	- ## 操作数
		- 操作数都要用带双引号的限定符去修饰
		- 格式为：``"constraint" (C expression)``
		- 输出操作数的限制要用"="来修饰
		- 限制主要用于指定操作数的寻址类型(内存寻址和寄存器寻址)，也用于指定使用的寄存器
		- 多个操作数之间**用逗号**隔开
		- 从第一个输出操作数为0开始算起，使用编号引用操作数
		- 如果输出表达式**不能直接寻址**，则需要指定寄存器来保存输出
		- 一般输出操作数必须是只写的
		- 使用**"r"**作为限定标识让gcc自己选择通用寄存器进行保存操作
	- ## Clobber List
		- 如果某个寄存器的值在asm指令中被改变了，需要在clobber list中显式地指出被修改地寄存器
		- 寄存器名字用双引号括起来，多个寄存器之间用逗号隔开
	- ## Volatile
		- 如果要求内联汇编的代码必须在程序对应的位置中被展开执行，而不会被编译器优化重排序，则可以加上volatile关键字，如果担心冲突，可以改用``__volatile__``
	- ## constraints
		- 待补充