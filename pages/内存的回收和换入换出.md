- # 内存分配到回收过程
- ``malloc``分配内存之后并不会立即划分物理内存，只有当访问虚拟地址但出现**缺页异常**之后由操作系统处理之后才会实际划拨物理内存
- 若发生缺页异常之后没有足够的物理内存用于划拨，则会开始进行**回收**工作，分为两种
	- **后台内存回收(kswapd)**
		- 物理内存紧张时，会唤醒``kswapd``**(Kernel SWAP Daemon)**守护线程回收内存
		- 此线程的回收过程是**异步**的，不会阻塞进程执行
	- **直接内存回收(direct reclaim)**
		- 若后台异步回收跟不上内存申请的速度，将开始直接回收，此过程是**同步**的，会阻塞当前进程
- 若直接内存回收都**无法满足**此次内存申请，将触发**[[$red]]==OOM(out of memory) 机制==**
	- OOM机制被触发时说明内存问题已经相当严重，操作系统会使用**极端方式**释放内存
	- OOM会选择内存占用较高的进程，发送``SIGKILL``，如果无法释放足够的内存将会强制终止进程
	- OOM会根据**内存使用量**，**优先级**等因素判断kill哪些进程，也会尽量避免杀死关键进程，以保证系统稳定性
	- 触发OOM机制将可能影响系统稳定性，一些用户进程将可能被异常终止并丢失数据
- ![](https://cdn.xiaolincoding.com//mysql/other/2f61b0822b3c4a359f99770231981b07.png){:height 686, :width 504}
- # 可回收的内存
	- 主要由两类文件
	- ## 文件页(File-backed Page)
		- 内核缓存的**磁盘数据(Buffer)**和内核缓冲的**文件数据**()
	- ## 匿名页